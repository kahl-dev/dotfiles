- defaults:
    link:
      relink: true
      create: true
      force: true
    shell:
      quiet: false
      stderr: true

- clean: []

- link:
    ~/.claude/agents: ./.claude.global/agents
    ~/.claude/commands: ./.claude.global/commands
    ~/.claude/hooks: ./.claude.global/hooks
    ~/.claude/instructions: ./.claude.global/instructions
    ~/.claude/shared: ./.claude.global/shared
    ~/.claude/settings.json: ./.claude.global/settings.json
    ~/.claude/statusline.sh: ./.claude.global/statusline.sh
    ~/.claude/CLAUDE.md: ./.claude.global/GLOBAL.CLAUDE.md

- shell:
    - description: "Create AI workspace directories for Claude"
      command: |
        mkdir -p ~/tmp/ai/screenshots \
                 ~/tmp/ai/jira \
                 ~/tmp/ai/exports \
                 ~/tmp/ai/figma \
                 ~/tmp/ai/downloads \
                 ~/tmp/ai/analysis \
                 ~/tmp/ai/cache
    - description: "Configure Claude statusLine in settings.json with backup"
      command: |
        SETTINGS_FILE="$HOME/.claude/settings.json"
        BACKUP_FILE="$HOME/.claude/settings.json.backup.$(date +%Y%m%d_%H%M%S)"
        TEMPLATE_FILE="$HOME/.dotfiles/.claude.global/settings.json"
        STATUSLINE_CONFIG='{
          "type": "command",
          "command": "~/.claude/statusline.sh",
          "padding": 0
        }'
        
        if [ -f "$SETTINGS_FILE" ]; then
          # Backup existing settings
          echo "Backing up existing settings to $BACKUP_FILE"
          cp "$SETTINGS_FILE" "$BACKUP_FILE"
          
          # Merge statusLine configuration
          echo "Updating statusLine configuration..."
          jq --argjson statusLine "$STATUSLINE_CONFIG" \
             '. + {statusLine: $statusLine}' \
             "$SETTINGS_FILE" > "$SETTINGS_FILE.tmp" && \
          mv "$SETTINGS_FILE.tmp" "$SETTINGS_FILE"
          echo "StatusLine configuration updated successfully"
        else
          # No existing file, copy template
          echo "Creating new settings.json from template..."
          cp "$TEMPLATE_FILE" "$SETTINGS_FILE"
          echo "Settings file created with statusLine configuration"
        fi

